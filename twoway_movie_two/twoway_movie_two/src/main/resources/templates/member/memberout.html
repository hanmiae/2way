<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>회원정보출력</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/theme.css}">

    <style>
        /* ✅ 이 페이지에서 상단바/드롭다운 클릭 먹통 방지용 */
        body { position: relative; }
        .page-layer { position: relative; z-index: 3; } /* 콘텐츠를 최상단으로 */
        /* 혹시 theme.css에 배경 오버레이가 깔려있으면 클릭을 막을 수 있어 → 강제로 무력화 */
        .bg, .bg::before, .bg::after,
        .hero-bg, .hero-bg::before, .hero-bg::after,
        .noise, .noise::before, .noise::after {
          pointer-events: none !important;
        }

        .mw-wrap{max-width:1200px;margin:26px auto 70px;padding:0 16px;}
        .mw-hero{display:flex;align-items:flex-end;justify-content:space-between;gap:14px;flex-wrap:wrap;margin:10px 0 14px}
        .mw-hero h1{margin:0;font-size:34px;letter-spacing:-.6px;font-weight:950;color:#fff}
        .mw-hero .sub{color:rgba(244,245,255,.72);font-weight:700;margin-top:6px}

        .glass{
          border-radius:24px;
          border:1px solid rgba(255,255,255,.10);
          background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
          box-shadow: 0 28px 90px rgba(0,0,0,.55);
          backdrop-filter: blur(18px);
          overflow:hidden;
        }
        .bar{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;
          padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.10)}
        .meta{color:rgba(244,245,255,.80);font-weight:900}

        .btnx{
          border:none;border-radius:14px;padding:10px 12px;font-weight:1000;cursor:pointer;
          display:inline-flex;align-items:center;justify-content:center;gap:8px;
          text-decoration:none;white-space:nowrap;
        }
        .primary{color:#fff;background:linear-gradient(135deg, rgba(255,43,214,.92), rgba(124,92,255,.80));
          box-shadow:0 18px 55px rgba(255,43,214,.20)}
        .ghost{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.14);color:#fff}

        .table-wrap{padding:16px;}
        table.mw-table{width:100%;border-collapse:separate;border-spacing:0}
        .mw-table thead th{
          text-align:left;padding:12px 12px;color:rgba(244,245,255,.85);font-weight:950;
          border-bottom:1px solid rgba(255,255,255,.10);font-size:13px;
        }
        .mw-table tbody td{
          padding:14px 12px;color:#fff;font-weight:800;
          border-bottom:1px solid rgba(255,255,255,.08);
          vertical-align:top;
        }
        .tr-hover:hover td{background:rgba(255,255,255,.05)}

        .pager{display:flex;justify-content:center;gap:10px;padding:0 16px 16px}
        .pill{
          display:inline-flex;align-items:center;gap:6px;
          padding:6px 10px;border-radius:999px;font-weight:950;font-size:12px;
          border:1px solid rgba(255,255,255,.14);
          background:rgba(255,255,255,.08);
          color:#fff;
        }
        .admin{border-color:rgba(255,59,129,.35);background:rgba(255,59,129,.16)}
        .user{border-color:rgba(0,229,255,.28);background:rgba(0,229,255,.12)}
    </style>
</head>

<body>
<!-- ✅ 상단바 -->
<div th:replace="~{layouts/top_public :: body}"></div>


<div class="page-layer">
    <main class="mw-wrap">

        <div class="mw-hero">
            <div>
                <h1>회원정보출력</h1>
                <div class="sub">회원 리스트 (ADMIN 전용 화면으로 쓰는 걸 추천)</div>
            </div>

            <div style="display:flex;gap:10px;flex-wrap:wrap">
                <a class="btnx ghost" th:href="@{/member_searchgo}">회원 검색</a>
                <a class="btnx primary" th:href="@{/}">메인</a>
            </div>
        </div>

        <section class="glass">
            <div class="bar">
                <div class="meta">
                    현재 페이지: <b th:text="${nowpage}">1</b> / <span th:text="${totalPage}">1</span>
                </div>
                <div class="meta" style="opacity:.9">
                    총 <b th:text="${list != null ? #lists.size(list) : 0}">0</b>명
                </div>
            </div>

            <div class="table-wrap">
                <table class="mw-table">
                    <thead>
                    <tr>
                        <th style="width:120px">번호</th>
                        <th style="width:220px">아이디</th>
                        <th style="width:180px">이름</th>
                        <th style="width:220px">연락처</th>
                        <th style="width:180px">권한</th>
                    </tr>
                    </thead>

                    <tbody>
                    <!-- ✅ 핵심: Controller에서 model에 넣은 이름이 list 이므로 list를 그대로 반복 -->
                    <tr class="tr-hover" th:each="m : ${list}">
                        <td th:text="${m.usernum}">1000</td>
                        <td th:text="${m.userid}">admin</td>
                        <td th:text="${m.username}">관리자</td>
                        <td th:text="${m.usertell}">010-0000-0000</td>
                        <td>
              <span class="pill admin" th:if="${m.role != null and #strings.contains(m.role,'ADMIN')}"
                    th:text="${m.role}">ROLE_ADMIN</span>
                            <span class="pill user" th:if="${m.role == null or !#strings.contains(m.role,'ADMIN')}"
                                  th:text="${m.role}">ROLE_USER</span>
                        </td>
                    </tr>

                    <!-- ✅ 데이터 없을 때 -->
                    <tr th:if="${list == null or #lists.isEmpty(list)}">
                        <td colspan="5" style="padding:22px">
                            <div style="color:rgba(244,245,255,.78);font-weight:950;font-size:14px">표시할 회원이 없습니다.</div>
                            <div style="color:rgba(244,245,255,.65);font-weight:800;font-size:12px;margin-top:6px">
                                DB에 데이터가 있는지 확인하거나, 컨트롤러 모델 이름(list)과 화면 반복 변수를 맞춰주세요.
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- ✅ 페이징 (Controller가 page를 0부터 받으므로 nowpage-1로 맞춰서 보냄) -->
            <div class="pager">
                <a class="btnx ghost"
                   th:if="${nowpage > 1}"
                   th:href="@{/member_outgo(page=${nowpage-2})}">이전</a>

                <a class="btnx ghost"
                   th:if="${nowpage < totalPage}"
                   th:href="@{/member_outgo(page=${nowpage})}">다음</a>
            </div>

        </section>

    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>
</div>

<!-- ✅ 드롭다운이 안 먹는 가장 큰 원인: 이 페이지에 bootstrap bundle이 없었음 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
